function  [Adj, Graph] = cal_modularity_connectivity(W,Ci)
% function to calcuate within and betwee community connectivity.



n=length(W);                        %number of vertices
Within_Degree = zeros(n,1);
Out_Degree = zeros(n,1);
for i=1:max(Ci)
    Within_Degree(Ci==i) = nansum(W(Ci==i,Ci==i),2);
    Out_Degree(Ci==i) = nansum(W(Ci==i,Ci~=i),2);
    Within_Weight(Ci==i) = nanmean(W(Ci==i,Ci==i),2);
    Out_Weight(Ci==i) = nanmean(W(Ci==i,Ci~=i),2);
end


